\Chapter{Pairings}

In dit hoofdstuk zal de werking van pairings wiskundig uit de doeken gedaan worden. Meer specifiek zal de Tate pairing bestudeerd worden. Er zal duidelijk gemaakt worden hoe de pairing berekend kan worden. Vervolgens worden enkele schema's voorgesteld die gebruikt kunnen worden voor versleuteling van gegevens en de aanmaak van digitale handtekeningen. In het volgende hoofdstuk wordt dan een schakeling ontworpen waarmee de Tate pairing berekend kan worden.

Enkel de hoogstnodige theorie zal hier behandeld worden. Voor een meer diepgaande uiteenzetting wordt opnieuw verwezen naar \cite{maas}. Het is ook uit dit werk dat de informatie uit de volgende paragrafen afkomstig is, tenzij anders vermeld.

\section{Inleidende wiskunde}

Alvorens de wiskundige theorie van pairings uit de doeken gedaan kan worden, dient die van elliptische krommen duidelijk gemaakt te worden. Het is met behulp van deze constructies dat pairings berekend kunnen worden. Elliptische krommen worden doorgaans echter gedefinieerd over een eindig veld. Vandaar dat de noodzakelijk theorie van beiden hier even heel kort herhaald wordt.

\subsection{Eindige velden}

Een eindig veld $\mathbb{F}_q$ wordt gedefinieerd door zijn karakteristiek $q$. Die karakteristiek is bij cryptografische toepassingen doorgaans een groot priemgetal $p$ of 2, hoewel tegenwoordig ook onderzoek gedaan wordt naar toepassingen met een karakteristiek 3. Een veld zonder zijn nul element wordt aangeduid als
\[\mathbb{F}_q^* = \mathbb{F}_q / \{ 0 \}.\]

Volgens de kleine stelling van Fermat geldt in elk eindig veld $a^q = a$. Van deze gelijkheid zal in het volgende hoofdstuk handig gebruikt gemaakt worden wanneer de inverse van een element moet berekend worden. Het voordeel van werken in een binair veld, m.a.w.\ $q = 2$, is dat optellingen en aftrekkingen equivalent zijn en zeer makkelijk uit te voeren zijn. Het is immers zo dat $1 + 1 = 2 \bmod 2 = 0$ en $0 - 1 = -1 \bmod 2 = 1$. Beiden kunnen dus berekend worden via een XOR operatie.

Verder kunnen extensies van graad $m$ van een veld gedefinieerd worden. In het geval $q = 2$ bekomt men dan een nieuw veld $\mathbb{F}_{2^m}$. Er dient dan ook een reductie veelterm $P$ opgegeven te worden. Een extensieveld wordt gedefinieerd als:
\[\mathbb{F}_{q^m} \cong \mathbb{F}_q [z] / (P). \]

\paragraph{Voorbeeld} Om de constructie van een extensieveld enigszins te verduidelijken wordt een klein voorbeeld gegeven. Er wordt gewerkt in karakteristiek $q = 2$. Stel $P = z^2 + z + 1$. Het extensieveld is dus gedefinieerd als:
\[\mathbb{F}_{2^2} \cong \mathbb{F}_2 [z] / (z^2 + z + 1). \]
Verder $A = z$ en $B = z + 1$. De resultaten van de optelling en vermenigvuldiging van $A$ en $B$ zijn dan respectievelijk:
\[\begin{aligned}
A + B &= 2z + 1 \qquad & A \cdot B &= z^2 + z\\
&= 1	& &= 2z + 1\\
\end{aligned}\]

\subsection{Elliptische krommen}

Een elliptische kromme $E$ wordt gevormd door de verzameling van punten die voldoen aan de vergelijking:
\[E: Y^2 Z + a_1 XYZ + a_2 Y Z^2 = X^3 + a_3 X^2 Z + a_4 X Z^2 + a_5 Z^3.\]
Het enige punt waarvoor $Z = 0$ en de vergelijking geldt ($X = 0,  Y = 1, Z = 0$), wordt het punt op oneindig $\mathcal{O}$ genoemd. Indien wordt gesteld dat $x = \frac{X}{Z}$ en $y = \frac{Y}{Z}$, bekomt men de affiene Weierstrass vergelijking:
\[E: y^2 + a_1 xy + a_2 y = x^3 + a_3 x^2 + a_4 x + a_5.\]
Merk op dat in deze vorm het punt $\mathcal{O}$ niet meer voldoet aan de vergelijking, ook al behoort het nog steeds tot de kromme. De kromme dient zo gedefinieerd te zijn dat $\forall A \in E$ de parti\"ele afgeleiden $\frac{\partial P}{\partial X}$, $\frac{\partial P}{\partial Y}$ en $\frac{\partial P}{\partial Z}$ nooit allen tegelijkertijd gelijk zijn aan nul.

De natuurlijke bewerking op een kromme is de ``tangent-and-chord'' methode, die wordt weergegeven in \reffig{figuur-pairings-tangent-and-chord}. De bewerking wordt additief geschreven en heeft als neutral element het punt op oneindig $\mathcal{O}$. Afhankelijk van het veld waarover de kromme gedefinieerd is, zullen de formules om de ``tangent-and-chord'' methode uit te voeren anders zijn. 

\begin{figure}[h]
	\centering
		\includegraphics[width=8cm]{tangent-and-add}
		\caption{``tangent-and-add'' methode op een elliptische kromme\label{figuur-pairings-tangent-and-chord}}
\end{figure}

Aan de hand van de vorige bewerking kan een scalaire vermenigvuldiging vastgelegd worden, met $a \in \mathbb{Z}$:
\[\begin{aligned}
a \cdot A	&= A + \ldots + A\\
0 \cdot A	&= \mathcal{O}\\
-a \cdot A	&= a \cdot -A
\end{aligned}\]

De orde $o$ van een punt $A$ op de kromme is gelijk aan de minimum waarde waarvoor $o \cdot A = \mathcal{O}$. Het is mogelijk dat $o = \infty$. Van alle punten waarvoor $o$ een deler is van $n$ wordt gezegd dat ze in de $n$-torsiesubgroep van $E$ zitten. Zo een subgroep wordt genoteerd als:
\[E[n] = \{ A \in E : n \cdot A = \mathcal{O} \}.\]

Het aantal punten $\#E$ op $E$ wordt de orde van de kromme genoemd. Voor een kromme over een veld $\mathbb{F}_q$ is $\#E = q + 1 - t$, met $t$ de ``trace'' van de kromme. Indien $q \mid t$ wordt de kromme supersingulier genoemd. Voor bepaalde types krommen bestaat er een gesloten formule voor $\#E$.

Ten slotte wordt nog de inbeddingsgraad $k$ gedefinieerd als het kleinste gehele getal waarvoor $n \mid q^k - 1$.

\section{Definitie van pairings}

Een pairing is in dit geval een functie $f(A, B)$ met als argumenten twee punten uit een additieve groep en als resultaat een punt in een multiplicatieve groep:
\[f(A, B): \mathbb{G}_1 \times \mathbb{G}_2 \rightarrow \mathbb{G}_T.\]
Een pairing moet tevens volgende eigenschappen bezitten: bilineariteit, non-degeneratie en moet goed gedefinieerd zijn. De betekenis van deze drie begrippen is:

\begin{enumerate}
	\item Bilineariteit: $\forall A_1, A_2, A \in \mathbb{G}_1$ en $\forall B_1, B_2, B \in \mathbb{G}_2$ geldt $f(A_1 + A_2, B) \equiv f(A_1, B) \cdot f(A_2, B)$ en $f(A, B_1 + B_2) \equiv f(A, B_1) \cdot f(A, B_2)$.

	\item Non-degeneratief: $\forall A \in \mathbb{G}_1, \: \exists B \in \mathbb{G}_2$ waarvoor $f(A, B) \neq 1$.

	\item Goed gedefinieerd: $\forall B \in \mathbb{G}_2$ is $f(A, B) = 1$ als en slechts als $A = \mathcal{O}$.
\end{enumerate}

Het zijn de drie eigenschappen waaraan pairings moeten voldoen die het zo moeilijk maken ze te genereren. Ten tijde van dit schrijven waren onder meer volgende pairings bekend: Weil, Tate, $\eta_T$ \cite{eta} en Ate \cite{ate}. In deze thesis zal gewerkt worden met de Tate pairing, waarvan bewezen is dat ze effici\"enter te berekenen is dan de Weil pairing.

De vermelde $\eta_T$ en Ate pairing zijn variaties op de Tate pairing die gebruikt kunnen worden indien voor specifieke elliptische krommen gekozen wordt. Indien aan de juiste voorwaarden voldaan wordt, zal de schakeling die in het volgende hoofdstuk wordt voorgesteld dus ook gebruikt kunnen worden om deze pairings te berekenen.

De definitie van de Tate pairing over elliptische krommen is als volgt:
\[e(A, B): E(\mathbb{F}_{q^k})[n] \times E(\mathbb{F}_{q^k})/n \cdot E(\mathbb{F}_{q^k}) \rightarrow \mathbb{F}_{q^k}^* / (\mathbb{F}_{q^k}^*)^n\]
Het resultaat van de Tate pairing is niet uniek, maar een element van een equivalentieklasse in $\mathbb{F}_{q^k}^* / (\mathbb{F}_{q^k}^*)^n$. Voor twee resultaten $a, b \in \mathbb{F}_{q^k}^*$ geldt $a \equiv b$ als en slechts als er een element $c \in \mathbb{F}_{q^k}^*$ waarvoor $a = bc^n$. Aangezien voor cryptografische toepassingen een uniek resultaat gewenst zal zijn, dient die $n$-de macht weggewerkt te worden. Dit kan door het resultaat te verheffen tot de macht $\frac{q^k - 1 }{n}$. Aangezien $a^{q^k - 1} = 1$ voor elke $a \in \mathbb{F}_{q^k}^*$ (kleine stelling van Fermat), verkrijgt men dan dus een $n$-eenheidswortel.

\section{Berekening van de Tate pairing}

Reeds in 1986 stelde Miller een methode voor om de Tate pairing te berekenen \cite{miller, barreto-efficient}. \refalg{algoritme-pairings-miller} geeft weer hoe dat algoritme  in z'n werk gaat.
