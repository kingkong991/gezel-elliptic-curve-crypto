\tikzset {
	and/.style={draw, and gate US, logic gate inputs=nn, rotate=90, xscale=-1, thick, scale=0.8},
	labelbox/.style={draw, chamfered rectangle, chamfered rectangle corners={north east, south east}, chamfered rectangle angle=55, chamfered rectangle xsep=2cm, chamfered rectangle ysep=14pt/2, minimum height=14pt, minimum width=1.2cm, text width=1cm, inner sep=0pt, outer sep=0pt, text ragged},
	labelboxin/.style={labelbox, anchor=base},
	labelboxout/.style={labelbox, anchor=west},
	labelboxreg/.style={draw, minimum height=14pt, minimum width=2cm, outer sep=0pt},
	joint/.style={inner sep=0mm, outer sep=0pt, text height=0mm, text width=0mm, minimum height=0.15cm, fill, circle},
	bit/.style={thick, line cap=butt},
	multibit/.style={line width=2pt},
	nothing/.style={inner sep=0mm, outer sep=0pt, text width=0mm, text height=0mm, minimum width=0.8pt},
	labeltext/.style={text ragged},
	labeltextin/.style={labeltext, anchor=west, xshift=-6mm},
	labeltextout/.style={labeltext, anchor=west, xshift=0mm},
	labeltextreg/.style={labeltext, text centered},
	mux/.style={draw, trapezium, trapezium stretches=true, rotate=-90, inner sep=1pt, minimum height=12pt, minimum width=1.2cm, xshift=2.2mm, outer sep=0pt},
	adder/.style={draw, circle, inner sep=0pt, outer sep=0pt, minimum size=5mm, semithick},
	gfcore/.style={draw, minimum height=1.4cm, minimum width=3cm, text width=2cm, text centered, semithick},
	rambox/.style={draw, minimum height=1.4cm, minimum width=3cm, text width=2cm, text centered, semithick}
}

\def\labelboxregl#1#2#3{\node[labeltextreg, #3] {#2}; \node[labelboxreg, #3] (#1) {}; \draw (#1.north west) -- ($(#1.north west)!0.5!(#1.south west) + (2mm, 0)$) -- (#1.south west);}

\def\labelboxregr#1#2#3{\node[labeltextreg, #3] {#2}; \node[labelboxreg, #3] (#1) {}; \draw (#1.north east) -- ($(#1.north east)!0.5!(#1.south east) + (-2mm, 0)$) -- (#1.south east);}

\def\labelboxin#1#2#3{\node[labeltextin, #3] {#2}; \node[labelboxin, #3] (#1) {};}
\def\labelboxout#1#2#3{\node[labeltextout, #3] {#2}; \node[labelboxout, #3] (#1) {};}

\def\muxsimple#1#2{\node[mux, #2] (#1) {}; \node[xshift=-0.5pt, anchor=west] at (#1.south west) {1}; \node[xshift=-0.5pt, anchor=west] at (#1.south east) {0};}

\def\mux#1#2{\node[mux, #2] (#1) {};}

\def\adder#1{\node[adder] (#1) {}; \draw [semithick] (#1.north) -- (#1.south) (#1.west) -- (#1.east);} 

\def\boxgfcore#1{\node[gfcore] (#1) {\Large $GF_{2^m}$ Core};}

\def\boxram#1#2{\node[rambox, #2] (#1) {\Large RAM};}

\begin{tikzpicture}
\matrix [column sep=1.5mm, row sep=1.5mm] {
	\labelboxin{i1}{start}{}; &[14mm]
	&[5mm]
	&[5mm]
	\labelboxregl{r1}{start}{}; \\

	\labelboxin{i2}{mode}{}; &
	&
	&
	\labelboxregl{r2}{mode}{}; \\[4mm]

	\labelboxin{i3}{A$_x$}{yshift=-1.1mm}; &
	\mux{m1}{xshift=2mm}; &
	\muxsimple{m2}{}; &
	\boxram{boxram}{yshift=-2.2mm}; &
	\node[joint, yshift=2mm] (j1) {}; &[11mm]
	\labelboxout{o1}{out$_x$}{yshift=2mm}; \\[-8mm]
	
	\labelboxin{i4}{A$_y$}{yshift=-0mm}; &
	&
	&
	&
	\node[joint, xshift=3mm, yshift=2mm] (j2) {}; &
	\labelboxout{o2}{out$_y$}{yshift=2mm}; \\
	
	\labelboxin{i5}{B$_x$}{};
	&
	&
	&
	&
	&
	\labelboxout{o3}{ready}{}; \\
	
	\labelboxin{i6}{B$_y$}{}; \\[-8mm]

	&
	&
	\node[nothing] (e1) {};&
	\boxgfcore{gfcore}; &
	&
	\node[nothing] (e2) {}; \\[1mm]

	&
	\node[nothing] (e3) {}; &
	&
	\labelboxregr{r3}{ready}{}; \\
};

\path[-]		(i1.east) edge [bit] (r1.west)
				(i2.east) edge [bit] (r2.west)
				(i3.east) edge [multibit, line cap=rect] ($(m1.south west) + (-3mm, 1mm)$)
				(i4.east) edge [multibit, line cap=rect] ($(i4.east) + (1mm, 0)$)
				(i5.east) edge [multibit, line cap=rect] ($(i5.east) + (1mm, 0)$)
				(i6.east) edge [multibit, line cap=rect] ($(i6.east) + (1mm, 0)$)
				(m2.north) edge [multibit] (boxram.west)
				(m1.north) edge [multibit] (m2.south east)
				(j1.base) edge [multibit] (o1.west)
				(j2.base) edge [multibit] (o2.west);
				
\draw[multibit]	($(m1.south west) + (-3mm, 1mm)$) -- ($(m1.south west) + (0, 1mm)$)	
						(i4.east) -| ($(i4.east)!0.55!(m1.south west) + (0, -1mm)$) |- ($(m1.south west) + (0, -1mm)$)
						(i5.east) -| ($(i5.east)!0.7!(m1.south east) + (0, 1mm)$) |- ($(m1.south east) + (0, 1mm)$)
						(i6.east) -| ($(i6.east)!0.85!(m1.south east) + (0, -1mm)$) |- ($(m1.south east) + (0, -1mm)$)
						($(e1.base) + (0, -4mm)$) -- node[very near start, below] {ctrl} ($(gfcore.west) + (0, -4mm)$);
						
\draw[multibit]	($(boxram.east) + (0, 4.2mm)$) -- (j1.base) |- ($(boxram.south west)!0.3!(gfcore.north west)$) -| (e1.base) -- (gfcore.west)
						($(boxram.east) + (0, -4.2mm)$) -- (j2.base) |- ($(boxram.south west)!0.7!(gfcore.north west)$) -| ($(e1.base)!0.5!(gfcore.west) + (0, 4mm)$) -- ($(gfcore.west) + (0, 4mm)$)
						($(gfcore.east) + (0, -3mm)$) -| ($(r3.east) + (7mm, 0)$) |- (r3.east)
						($(gfcore.east) + (0, 3mm)$) -| ($(boxram.north east) + (8mm, 0)$) |- ($(boxram.north west)!0.3!(r2.south west)$) -| ($(m2.south west) + (-2mm, 0)$)  |- (m2.south west);
						
\draw[bit]	(o3.west) -- ($(o3.west) + (-6mm, 0)$);

\draw[multibit, color=black!50] ($(i1.east) + (6mm, 5mm)$) rectangle ($(r3.south east) + (18mm, -2mm)$);
\end{tikzpicture}