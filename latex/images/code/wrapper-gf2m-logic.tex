\tikzset {
	and/.style={draw, and gate US, logic gate inputs=nn, thick, scale=0.8},
	or/.style={draw, or gate US, logic gate inputs=nn, thick, scale=0.8},
	xor/.style={draw, xor gate US, logic gate inputs=nn, line width=0.6pt, scale=0.8},
	equal/.style={draw, minimum height=5mm, minimum width=8mm, thick, scale=0.8},	
	joint/.style={inner sep=0mm, outer sep=0pt, text height=0mm, text width=0mm, minimum height=0.10cm, fill, circle},
	bit/.style={thick, line cap=butt},
	multibit/.style={line width=2pt},
	labeltext/.style={text ragged},
	labeltextin/.style={labeltext, anchor=west, xshift=-6mm},
	labeltextout/.style={labeltext, anchor=west, xshift=0mm},
	labeltextreg/.style={labeltext, text centered},
	labelbox/.style={draw, chamfered rectangle, chamfered rectangle corners={north east, south east}, chamfered rectangle angle=55, chamfered rectangle xsep=2cm, chamfered rectangle ysep=14pt/2, minimum height=14pt, minimum width=1.2cm, text width=1cm, inner sep=0pt, outer sep=0pt, text ragged},
	labelboxin/.style={labelbox, anchor=base, xshift=0.8mm},
	labelboxout/.style={labelbox, anchor=west},
	labelboxreg/.style={draw, minimum height=14pt, minimum width=2cm, outer sep=0pt},
	empty/.style={},
	emptyraised/.style={empty, yshift=1mm},
	emptylowered/.style={empty, yshift=-1mm},
	input/.style={at start, above, text width=2cm, xshift=10mm, yshift=-0.7mm},
	output/.style={at end, above, anchor=south east, xshift=-1mm, yshift=-0.7mm},
	outputline/.style={-latex'}
}

\def\labelboxin#1#2#3{\node[labeltextin, #3] {#2}; \node[labelboxin, #3] (#1) {};}

\begin{tikzpicture}
%\draw[help lines] (-3,-3) grid (2,2);
\matrix [column sep=5mm, row sep=1.5mm] {
	\node[emptyraised] (e1) {}; &
	&
	&
	\node[and, logic gate inputs=in] (and1) {};\\
	
	\node[emptyraised] (e2) {}; &
	&
	\node[or, logic gate inputs=in] (or1) {};\\
	
	\node[empty] (e3) {}; &
	\node[equal] (equal1) {$= m - 2$};\\
	
	\\[5mm]
	
	\node[empty] (e4) {}; \\
	
	\node[emptylowered] (e5) {}; &
	\node[and] (and2) {}; &
	\node[or, yshift=-5mm] (or2) {}; \\[-2mm]
	
	\node[emptylowered] (e6) {}; &
	\node[and, logic gate inputs=in] (and3) {};\\
	
	\\[5mm]
	
	\node[empty] (e7) {}; \\
	
	\node[emptylowered] (e8) {}; &
	\node[and] (and4) {}; &
	\node[or, yshift=-5mm] (or3) {}; \\[-2mm]
	
	\node[emptylowered] (e9) {}; &
	\node[and, logic gate inputs=in] (and5) {};\\
	
	\\[5mm]
	
	\node[emptyraised] (e10) {}; &
	&
	\node[and, logic gate inputs=in] (and6) {};\\
	
	\node[emptyraised] (e11) {}; &
	\node[or, logic gate inputs=in] (or4) {};\\
	
	\node[empty] (e12) {}; \\
};

\draw [bit] (or1.output) -| ($(or1.output)!0.5!(and1.input 2)$) |- (and1.input 2)
		(equal1.east) -| ($(equal1.east)!0.5!(or1.input 2)$) |- (or1.input 2)
		(and1.input 1 -| -3,0) -- node[input] {start} (and1.input 1)
		(or1.input 1 -| -3,0) -- node[input] {mode$_{\text{reg}}$} (or1.input 1)
		(equal1.west -| -3,0) -- node[input] {cycle$_{\text{reg}}$} (equal1.west)
		(and1.output) [outputline] -- node[output] {ready} (and1.output -| 3.5, 0);
		
\draw [bit] (and2.output) -| ($(and2.output)!0.5!(or2.input 1)$) |- (or2.input 1)
		(and3.output) -| ($(and3.output)!0.5!(or2.input 2)$) |- (or2.input 2)
		(e4 -| -3, 0) -| node[input] {start} ($(and2.input 1) - (2.5mm, 0)$) |- (and2.input 1)
		($(and2.input 1) - (2.5mm, 0)$) |- node[joint, at start] {} (and3.input 1)
		(and2.input 2 -| -3, 0) -- node[input] {mode} (and2.input 2)
		(and3.input 2 -| -3, 0) -- node[input] {mode$_{\text{reg}}$} (and3.input 2)
		(or2.output) [outputline] -- node[output] {mode$_{\text{reg}}$} (or2.output -| 3.5, 0);
		
\draw [bit] (and4.output) -| ($(and4.output)!0.5!(or3.input 1)$) |- (or3.input 1)
		(and5.output) -| ($(and5.output)!0.5!(or3.input 2)$) |- (or3.input 2)
		(e7 -| -3, 0) -| node[input] {start} ($(and4.input 1) - (2.5mm, 0)$) |- (and4.input 1)
		($(and4.input 1) - (2.5mm, 0)$) |- node[joint, at start] {} (and5.input 1)
		(and4.input 2 -| -3, 0) -- node[input] {plus\_1} (and4.input 2)
		(and5.input 2 -| -3, 0) -- node[input] {plus\_1$_{\text{reg}}$} (and5.input 2)
		(or3.output) [outputline] -- node[output] {plus\_1$_{\text{reg}}$} (or3.output -| 3.5, 0);
		
\draw [bit] (or4.output) -| ($(or4.output)!0.5!(and6.input 2)$) |- (and6.input 2)
		(and6.input 1 -| -3, 0) -| node[input] {ready$_{i - 1}$} (and6.input 1)
		(or4.input 1 -| -3, 0) -- node[input] {mode$_{\text{reg}}$} (or4.input 1)
		(e12 -| -3, 0) -| node[input] {A$_{m-1}$} ($(or4.input 2) - (2.5mm, 0)$) |- (or4.input 2)
		(and6.output) [outputline] -- node[output] {B$_{\text{and}}$} (and6.output -| 3.5, 0);
\end{tikzpicture}
